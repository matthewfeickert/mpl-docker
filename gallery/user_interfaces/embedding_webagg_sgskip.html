
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Embedding WebAgg &#8212; Matplotlib 3.3.0rc1+229.g97785f2e6 documentation</title>
    <link rel="stylesheet" href="../../_static/mpl.css?v3.3.0rc1-229-g97785f2e6" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-dataframe.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Matplotlib 3.3.0rc1+229.g97785f2e6 documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>

    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<link rel="top" title="Matplotlib 3.3.0rc1+229.g97785f2e6 documentation" href="#" />
    <link rel="canonical" href="https://matplotlib.org/devdocs/gallery/user_interfaces/embedding_webagg_sgskip.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>

<div id="unreleased-message">
    You are reading documentation for the unreleased version of Matplotlib.
    <a href="https://matplotlib.org/search.html?q=Embedding%20WebAgg&amp;check_keywords=yes&amp;area=default">
        Try searching for the released version of this page instead?
    </a>
</div>

<!--
<div id="annc-banner">

</div>
-->

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px; position: relative;">
    <a href="../../index.html">
        <div style="float: left; position: absolute; width: 496px; bottom: 0; padding-bottom: 24px"><span style="float: right; color: #789; background: white">Version 3.3.0rc1+229.g97785f2e6</span></div>
        <img src="../../_static/logo2_compressed.svg" height="125px" border="0" alt="matplotlib"/></a>

    <!-- The "Fork me on github" ribbon -->
    <div id="forkongithub"><a href="https://github.com/matplotlib/matplotlib">Fork me on GitHub</a></div>
    </div>

    <nav class="main-nav">
        <ul>
            <li><a href="../../users/installing.html">Installation</a></li>
            <li><a href="../../contents.html">Documentation</a></li>
            <li><a href="../index.html">Examples</a></li>
            <li><a href="../../tutorials/index.html">Tutorials</a></li>
            <li><a href="../../devel/index.html">Contributing</a></li>
            <li class="nav-right">
                <form class="search" action="../../search.html" method="get">
                <input type="text" name="q" aria-labelledby="searchlabel" placeholder="Search"/>
                </form>
            </li>
        </ul>
     </nav>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">home</a>|&nbsp;</li>
        <li><a href="../../contents.html">contents</a> &raquo;</li>
        <li class="nav-item nav-item-this"><a href="">Embedding WebAgg</a></li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../contents.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div id="sidebar-pagesource" role="note" aria-label="source link"
    style="margin-top: 1.5em; padding-top: 0.1em; border-top: 1px solid #86989b">
  <a href="../../_sources/gallery/user_interfaces/embedding_webagg_sgskip.rst.txt"
     style="color: #c0c0c0" rel="nofollow">Show Page Source</a>
  </div>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Click <a class="reference internal" href="#sphx-glr-download-gallery-user-interfaces-embedding-webagg-sgskip-py"><span class="std std-ref">here</span></a>     to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="embedding-webagg">
<span id="sphx-glr-gallery-user-interfaces-embedding-webagg-sgskip-py"></span><h1>Embedding WebAgg<a class="headerlink" href="#embedding-webagg" title="Permalink to this headline">Â¶</a></h1>
<p>This example demonstrates how to embed Matplotlib WebAgg interactive plotting
in your own web application and framework.  It is not necessary to do all this
if you merely want to display a plot in a browser or use Matplotlib's built-in
Tornado-based server &quot;on the side&quot;.</p>
<p>The framework being used must support web sockets.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">mimetypes</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="pathlib.Path" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Path</span></a>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">tornado</span>
<span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This example requires tornado.&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
<span class="kn">import</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span>
<span class="kn">import</span> <span class="nn">tornado.httpserver</span>
<span class="kn">import</span> <span class="nn">tornado.ioloop</span>
<span class="kn">import</span> <span class="nn">tornado.websocket</span>


<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_webagg_core</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">FigureManagerWebAgg</span><span class="p">,</span> <span class="n">new_figure_manager_given_figure</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">matplotlib.figure</span> <span class="kn">import</span> <a href="../../api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Figure</span></a>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="k">def</span> <span class="nf">create_figure</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a simple example figure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <a href="../../api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Figure</span></a><span class="p">()</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.sin.html#numpy.sin" title="numpy.sin" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">sin</span></a><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <a href="https://docs.scipy.org/doc/numpy/reference/constants.html#numpy.pi" title="numpy.pi" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span>


<span class="c1"># The following is the content of the web page.  You would normally</span>
<span class="c1"># generate this using some sort of template facility in your web</span>
<span class="c1"># framework, but here we just use Python string formatting.</span>
<span class="n">html_content</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;html&gt;</span>
<span class="s2">  &lt;head&gt;</span>
<span class="s2">    &lt;!-- TODO: There should be a way to include all of the required javascript</span>
<span class="s2">               and CSS so matplotlib can add to the set in the future if it</span>
<span class="s2">               needs to. --&gt;</span>
<span class="s2">    &lt;link rel=&quot;stylesheet&quot; href=&quot;_static/css/page.css&quot; type=&quot;text/css&quot;&gt;</span>
<span class="s2">    &lt;link rel=&quot;stylesheet&quot; href=&quot;_static/css/boilerplate.css&quot;</span>
<span class="s2">          type=&quot;text/css&quot; /&gt;</span>
<span class="s2">    &lt;link rel=&quot;stylesheet&quot; href=&quot;_static/css/fbm.css&quot; type=&quot;text/css&quot; /&gt;</span>
<span class="s2">    &lt;link rel=&quot;stylesheet&quot; href=&quot;_static/css/mpl.css&quot; type=&quot;text/css&quot;&gt;</span>
<span class="s2">    &lt;script src=&quot;mpl.js&quot;&gt;&lt;/script&gt;</span>

<span class="s2">    &lt;script&gt;</span>
<span class="s2">      /* This is a callback that is called when the user saves</span>
<span class="s2">         (downloads) a file.  Its purpose is really to map from a</span>
<span class="s2">         figure and file format to a url in the application. */</span>
<span class="s2">      function ondownload(figure, format) {</span>
<span class="s2">        window.open(&#39;download.&#39; + format, &#39;_blank&#39;);</span>
<span class="s2">      };</span>

<span class="s2">      function ready(fn) {</span>
<span class="s2">        if (document.readyState != &quot;loading&quot;) {</span>
<span class="s2">          fn();</span>
<span class="s2">        } else {</span>
<span class="s2">          document.addEventListener(&quot;DOMContentLoaded&quot;, fn);</span>
<span class="s2">        }</span>
<span class="s2">      }</span>

<span class="s2">      ready(</span>
<span class="s2">        function() {</span>
<span class="s2">          /* It is up to the application to provide a websocket that the figure</span>
<span class="s2">             will use to communicate to the server.  This websocket object can</span>
<span class="s2">             also be a &quot;fake&quot; websocket that underneath multiplexes messages</span>
<span class="s2">             from multiple figures, if necessary. */</span>
<span class="s2">          var websocket_type = mpl.get_websocket_type();</span>
<span class="s2">          var websocket = new websocket_type(&quot;</span><span class="si">%(ws_uri)s</span><span class="s2">ws&quot;);</span>

<span class="s2">          // mpl.figure creates a new figure on the webpage.</span>
<span class="s2">          var fig = new mpl.figure(</span>
<span class="s2">              // A unique numeric identifier for the figure</span>
<span class="s2">              </span><span class="si">%(fig_id)s</span><span class="s2">,</span>
<span class="s2">              // A websocket object (or something that behaves like one)</span>
<span class="s2">              websocket,</span>
<span class="s2">              // A function called when a file type is selected for download</span>
<span class="s2">              ondownload,</span>
<span class="s2">              // The HTML element in which to place the figure</span>
<span class="s2">              document.getElementById(&quot;figure&quot;));</span>
<span class="s2">        }</span>
<span class="s2">      );</span>
<span class="s2">    &lt;/script&gt;</span>

<span class="s2">    &lt;title&gt;matplotlib&lt;/title&gt;</span>
<span class="s2">  &lt;/head&gt;</span>

<span class="s2">  &lt;body&gt;</span>
<span class="s2">    &lt;div id=&quot;figure&quot;&gt;</span>
<span class="s2">    &lt;/div&gt;</span>
<span class="s2">  &lt;/body&gt;</span>
<span class="s2">&lt;/html&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">MyApplication</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">Application</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">MainPage</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Serves the main HTML page.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">manager</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">manager</span>
            <span class="n">ws_uri</span> <span class="o">=</span> <span class="s2">&quot;ws://</span><span class="si">{req.host}</span><span class="s2">/&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">req</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">)</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">html_content</span> <span class="o">%</span> <span class="p">{</span>
                <span class="s2">&quot;ws_uri&quot;</span><span class="p">:</span> <span class="n">ws_uri</span><span class="p">,</span> <span class="s2">&quot;fig_id&quot;</span><span class="p">:</span> <span class="n">manager</span><span class="o">.</span><span class="n">num</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">MplJs</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Serves the generated matplotlib javascript file.  The content</span>
<span class="sd">        is dynamically generated based on which toolbar functions the</span>
<span class="sd">        user has defined.  Call `FigureManagerWebAgg` to get its</span>
<span class="sd">        content.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s1">&#39;application/javascript&#39;</span><span class="p">)</span>
            <span class="n">js_content</span> <span class="o">=</span> <span class="n">FigureManagerWebAgg</span><span class="o">.</span><span class="n">get_javascript</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">js_content</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Download</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handles downloading of the figure in various file formats.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fmt</span><span class="p">):</span>
            <span class="n">manager</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">manager</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span>
                <span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="n">mimetypes</span><span class="o">.</span><span class="n">types_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="s1">&#39;binary&#39;</span><span class="p">))</span>
            <span class="n">buff</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/io.html#io.BytesIO" title="io.BytesIO" class="sphx-glr-backref-module-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span></a><span class="p">()</span>
            <span class="n">manager</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buff</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buff</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span>

    <span class="k">class</span> <span class="nc">WebSocket</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">websocket</span><span class="o">.</span><span class="n">WebSocketHandler</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A websocket for interactive communication between the plot in</span>
<span class="sd">        the browser and the server.</span>

<span class="sd">        In addition to the methods required by tornado, it is required to</span>
<span class="sd">        have two callback methods:</span>

<span class="sd">            - ``send_json(json_content)`` is called by matplotlib when</span>
<span class="sd">              it needs to send json to the browser.  `json_content` is</span>
<span class="sd">              a JSON tree (Python dictionary), and it is the responsibility</span>
<span class="sd">              of this implementation to encode it as a string to send over</span>
<span class="sd">              the socket.</span>

<span class="sd">            - ``send_binary(blob)`` is called to send binary image data</span>
<span class="sd">              to the browser.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">supports_binary</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="c1"># Register the websocket with the FigureManager.</span>
            <span class="n">manager</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">manager</span>
            <span class="n">manager</span><span class="o">.</span><span class="n">add_web_socket</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;set_nodelay&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_nodelay</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">on_close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="c1"># When the socket is closed, deregister the websocket with</span>
            <span class="c1"># the FigureManager.</span>
            <span class="n">manager</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">manager</span>
            <span class="n">manager</span><span class="o">.</span><span class="n">remove_web_socket</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">on_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
            <span class="c1"># The &#39;supports_binary&#39; message is relevant to the</span>
            <span class="c1"># websocket itself.  The other messages get passed along</span>
            <span class="c1"># to matplotlib as-is.</span>

            <span class="c1"># Every message has a &quot;type&quot; and a &quot;figure_id&quot;.</span>
            <span class="n">message</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/json.html#json.loads" title="json.loads" class="sphx-glr-backref-module-json sphx-glr-backref-type-py-function"><span class="n">json</span><span class="o">.</span><span class="n">loads</span></a><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;supports_binary&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">supports_binary</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">manager</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">manager</span>
                <span class="n">manager</span><span class="o">.</span><span class="n">handle_json</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">send_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_message</span><span class="p">(</span><a href="https://docs.python.org/3/library/json.html#json.dumps" title="json.dumps" class="sphx-glr-backref-module-json sphx-glr-backref-type-py-function"><span class="n">json</span><span class="o">.</span><span class="n">dumps</span></a><span class="p">(</span><span class="n">content</span><span class="p">))</span>

        <span class="k">def</span> <span class="nf">send_binary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">blob</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">supports_binary</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write_message</span><span class="p">(</span><span class="n">blob</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data_uri</span> <span class="o">=</span> <span class="s2">&quot;data:image/png;base64,</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">blob</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;base64&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write_message</span><span class="p">(</span><span class="n">data_uri</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">figure</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="n">figure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">manager</span> <span class="o">=</span> <span class="n">new_figure_manager_given_figure</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">figure</span><span class="p">),</span> <span class="n">figure</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([</span>
            <span class="c1"># Static files for the CSS and JS</span>
            <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;/_static/(.*)&#39;</span><span class="p">,</span>
             <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">StaticFileHandler</span><span class="p">,</span>
             <span class="p">{</span><span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">FigureManagerWebAgg</span><span class="o">.</span><span class="n">get_static_file_path</span><span class="p">()}),</span>

            <span class="c1"># Static images for the toolbar</span>
            <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;/_images/(.*)&#39;</span><span class="p">,</span>
             <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">StaticFileHandler</span><span class="p">,</span>
             <span class="p">{</span><span class="s1">&#39;path&#39;</span><span class="p">:</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="pathlib.Path" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Path</span></a><span class="p">(</span><a href="../../api/matplotlib_configuration_api.html#matplotlib.get_data_path" title="matplotlib.get_data_path" class="sphx-glr-backref-module-matplotlib sphx-glr-backref-type-py-function"><span class="n">mpl</span><span class="o">.</span><span class="n">get_data_path</span></a><span class="p">(),</span> <span class="s1">&#39;images&#39;</span><span class="p">)}),</span>

            <span class="c1"># The page that contains all of the pieces</span>
            <span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MainPage</span><span class="p">),</span>

            <span class="p">(</span><span class="s1">&#39;/mpl.js&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MplJs</span><span class="p">),</span>

            <span class="c1"># Sends images and events to the browser, and receives</span>
            <span class="c1"># events from the browser</span>
            <span class="p">(</span><span class="s1">&#39;/ws&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">WebSocket</span><span class="p">),</span>

            <span class="c1"># Handles the downloading (i.e., saving) of static images</span>
            <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;/download.([a-z0-9.]+)&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Download</span><span class="p">),</span>
        <span class="p">])</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">figure</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">()</span>
    <span class="n">application</span> <span class="o">=</span> <span class="n">MyApplication</span><span class="p">(</span><span class="n">figure</span><span class="p">)</span>

    <span class="n">http_server</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">httpserver</span><span class="o">.</span><span class="n">HTTPServer</span><span class="p">(</span><span class="n">application</span><span class="p">)</span>
    <span class="n">http_server</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">8080</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;http://127.0.0.1:8080/&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Press Ctrl+C to quit&quot;</span><span class="p">)</span>

    <span class="n">tornado</span><span class="o">.</span><span class="n">ioloop</span><span class="o">.</span><span class="n">IOLoop</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-gallery-user-interfaces-embedding-webagg-sgskip-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<a class="reference download internal" download="" href="../../_downloads/d558d74d36a57f66fc595a6bb564b180/embedding_webagg_sgskip.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">embedding_webagg_sgskip.py</span></code></a></div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<a class="reference download internal" download="" href="../../_downloads/b5cbdfa83b33e22687e6420da37101b9/embedding_webagg_sgskip.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">embedding_webagg_sgskip.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature">Keywords: matplotlib code example, codex, python plot, pyplot
<a class="reference external" href="https://sphinx-gallery.readthedocs.io">Gallery generated by Sphinx-Gallery</a></p>
</div>


          </div>
          
        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer>
    <div class="footer">
    &copy; Copyright 2002 - 2012 John Hunter, Darren Dale, Eric Firing, Michael Droettboom and the Matplotlib development team; 2012 - 2020 The Matplotlib development team.
<br />
    Last updated on Jul 12, 2020.
Created using
<a href="http://sphinx-doc.org/">Sphinx</a> 3.1.2.
Doc version v3.3.0rc1-229-g97785f2e6.
    </div>
</footer>
<script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-55954603-1', 'auto');
        ga('send', 'pageview');

</script>
  </body>
</html>